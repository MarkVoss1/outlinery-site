<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Outlinery | Independent Publishing</title>
    <style>
        /* Importing Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@300;400;700&display=swap');

        /* --- CORE VARIABLES --- */
        :root {
            --brand-dark: #1a1a1a;
            --brand-accent: #e76f51; 
            --bg-color: #ffffff;
            --bg-off-white: #faf9f6;
            --text-main: #2c3e50;
            --amazon-yellow: #ffd814;
            --amazon-orange: #fa8900;
        }

        * { box-sizing: border-box; }
        
        body {
            font-family: 'Lato', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-main);
        }

        /* --- NAVIGATION --- */
        nav {
            background-color: #fff;
            padding: 1.2rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 10px rgba(0,0,0,0.05);
            border-bottom: 1px solid #eee;
        }

        .brand-logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--brand-dark);
            cursor: pointer;
            letter-spacing: 0.5px;
        }
        
        .nav-links { display: flex; gap: 20px; }

        .nav-links button {
            background: none;
            border: none;
            color: #555;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: color 0.3s;
        }

        .nav-links button:hover, .nav-links button.active { color: var(--brand-accent); }

        /* --- SECTIONS --- */
        .view-section { display: none; animation: fadeIn 0.4s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- HERO SECTION --- */
        .hero {
            position: relative;
            height: 75vh;
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-color: var(--brand-dark);
        }

        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.5;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: white;
            max-width: 800px;
            padding: 20px;
        }

        .hero-content h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            margin-bottom: 1rem;
            line-height: 1.1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .hero-content p {
            font-size: 1.25rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            font-weight: 300;
            opacity: 0.95;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .cta-btn {
            background-color: white;
            color: var(--brand-dark);
            padding: 16px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .cta-btn:hover {
            background-color: var(--brand-accent);
            color: white;
            transform: translateY(-2px);
        }

        /* --- ABOUT US STRIP --- */
        .about-strip {
            background-color: var(--bg-off-white);
            padding: 4rem 2rem;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        .about-strip h2 { font-family: 'Playfair Display', serif; margin-bottom: 1rem; font-size: 2rem; }
        .about-strip p { max-width: 700px; margin: 0 auto; line-height: 1.8; color: #555; font-size: 1.1rem; }

        /* --- CATALOGUE GRID --- */
        .catalogue-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 1.5rem;
        }

        .grid-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        .grid-header h2 { font-family: 'Playfair Display', serif; font-size: 2.5rem; margin: 0; }
        .grid-header p { color: #888; margin-top: 10px; }

        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 40px 30px;
        }

        .book-card {
            cursor: pointer;
            transition: transform 0.3s;
        }
        .book-card:hover { transform: translateY(-5px); }

        .book-cover {
            width: 100%;
            aspect-ratio: 1/1; /* Square format based on Book 1 description */
            background-color: #f0f0f0;
            border-radius: 4px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .book-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover; 
            /* Changed to cover so it fills the square nicely */
        }

        .book-info h3 {
            font-size: 1.1rem;
            margin: 0 0 5px 0;
            font-weight: 700;
            color: var(--brand-dark);
            line-height: 1.4;
        }
        .book-info .category {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: #999;
            letter-spacing: 1px;
            margin-bottom: 5px;
            display: block;
        }
        .book-info .price {
            color: var(--brand-accent);
            font-weight: bold;
            margin-top: 5px;
        }

        /* --- PRODUCT DETAIL VIEW --- */
        .product-view {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #666;
            text-decoration: none;
            font-weight: 600;
        }

        .product-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 3rem;
        }

        /* Gallery Styles */
        .gallery-wrapper {
            position: relative;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 1/1;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            border: 1px solid #eee;
        }

        .gallery-track {
            display: flex;
            height: 100%;
            transition: transform 0.3s ease-out;
        }
        
        .gallery-slide {
            min-width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
        }
        
        .gallery-slide img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .gallery-dots {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 15px 0;
        }
        .dot { width: 10px; height: 10px; border-radius: 50%; background: #ddd; }
        .dot.active { background: var(--brand-dark); }

        /* Product Info Side */
        .product-details h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            margin: 0 0 10px 0;
            line-height: 1.2;
        }
        
        .product-meta { color: #666; font-style: italic; margin-bottom: 1.5rem; }
        
        .product-desc {
            line-height: 1.8;
            color: #444;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1.5rem;
            white-space: pre-wrap; /* Preserves paragraph spacing */
        }

        .amazon-box {
            background: #fdfdfd;
            border: 1px solid #eee;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
        }

        .amz-btn {
            display: block;
            width: 100%;
            padding: 16px;
            text-align: center;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            margin-bottom: 12px;
            transition: filter 0.2s;
            font-size: 1.1rem;
        }
        .amz-cart { background-color: var(--amazon-yellow); color: #111; }
        .amz-buy { background-color: var(--amazon-orange); color: #111; }
        .amz-btn:hover { filter: brightness(0.95); }

        /* --- ADDED: NEWSLETTER SECTION CSS --- */
        .newsletter-section {
            background: linear-gradient(135deg, #2c3e50, #4ca1af);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            margin-top: 4rem;
        }
        
        .newsletter-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .newsletter-section h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            margin-bottom: 1rem;
        }

        .newsletter-section p {
            margin-bottom: 2rem;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .newsletter-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .newsletter-form input {
            padding: 15px;
            border-radius: 50px;
            border: none;
            flex: 1;
            min-width: 250px;
            font-size: 1rem;
        }

        .newsletter-form button {
            background-color: var(--brand-accent);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: transform 0.2s;
        }

        .newsletter-form button:hover { transform: scale(1.05); }

        /* --- ADDED: COOKIE BANNER CSS --- */
        .cookie-banner {
            position: fixed;
            bottom: -100px; /* Hidden by default */
            left: 0;
            width: 100%;
            background: #222;
            color: white;
            padding: 15px 20px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            z-index: 9999;
            transition: bottom 0.5s ease;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            font-size: 0.9rem;
            flex-wrap: wrap;
        }

        .cookie-banner.show { bottom: 0; }

        .cookie-btn {
            background: white;
            color: #222;
            border: none;
            padding: 8px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Footer */
        footer {
            background-color: var(--brand-dark);
            color: white;
            text-align: center;
            padding: 3rem 1rem;
            margin-top: 0; /* Adjusted for newsletter */
        }

        /* Desktop Layout */
        @media(min-width: 768px) {
            .product-layout { grid-template-columns: 1fr 1fr; gap: 4rem; }
            .hero-content h1 { font-size: 4.5rem; }
        }
    </style>
</head>
<body>

    <!-- NAV -->
    <nav>
        <div class="brand-logo" onclick="router('home')">The Outlinery</div>
        <div class="nav-links">
            <button id="nav-home" class="active" onclick="router('home')">Home</button>
            <button id="nav-shop" onclick="router('shop')">Shop</button>
        </div>
    </nav>

    <!-- VIEW: HOME -->
    <section id="view-home" class="view-section active">
        <div class="hero">
            <!-- UPDATED HERO IMAGE -->
            <img src="images/background-home.png" class="hero-bg" alt="Creative workspace background" 
                 onerror="this.src='https://images.unsplash.com/photo-1596464716127-f2a82984de30?q=80&w=1600&auto=format&fit=crop'">
            
            <div class="hero-content">
                <h1>Creativity Starts Here</h1>
                <p>Color your world with our exclusive collection of hand-drawn journals and activity books.</p>
                <button class="cta-btn" onclick="router('shop')">View Catalogue</button>
            </div>
        </div>

        <div class="about-strip">
            <h2>Welcome to The Outlinery</h2>
            <p>
                We are an independent publishing firm who designs coloring books, 
                activity books, journals, and notebooks in-house with our talented artists.
                <br><br>
                Whether you need to organize your day or find a peaceful escape through art, 
                our books are crafted to inspire.
            </p>
        </div>
    </section>

    <!-- VIEW: SHOP / CATALOGUE -->
    <section id="view-shop" class="view-section">
        <div class="catalogue-container">
            <div class="grid-header">
                <h2>Our Collection</h2>
                <p>Browse books designed for mindfulness and fun.</p>
            </div>
            
            <div class="book-grid" id="product-grid">
                <!-- Javascript will inject books here -->
            </div>
        </div>
    </section>

    <!-- VIEW: PRODUCT DETAIL -->
    <section id="view-product" class="view-section">
        <div class="product-view">
            <a href="#" class="back-link" onclick="router('shop'); return false;">&larr; Back to Shop</a>
            
            <div class="product-layout">
                <!-- Gallery Left -->
                <div>
                    <div class="gallery-wrapper" id="gallery-touch-area">
                        <div class="gallery-track" id="track">
                            <!-- Slides -->
                        </div>
                        <!-- Arrows for Desktop -->
                        <div style="position:absolute; top:50%; width:100%; display:flex; justify-content:space-between; padding:0 10px; transform:translateY(-50%); pointer-events:none;">
                            <button onclick="moveSlide(-1)" style="pointer-events:all; background:white; border:none; width:40px; height:40px; border-radius:50%; box-shadow:0 2px 5px rgba(0,0,0,0.2); cursor:pointer;">&larr;</button>
                            <button onclick="moveSlide(1)" style="pointer-events:all; background:white; border:none; width:40px; height:40px; border-radius:50%; box-shadow:0 2px 5px rgba(0,0,0,0.2); cursor:pointer;">&rarr;</button>
                        </div>
                    </div>
                    <div class="gallery-dots" id="dots-container"></div>
                </div>

                <!-- Info Right -->
                <div class="product-details">
                    <h1 id="p-title">Book Title</h1>
                    <div class="product-meta">By The Outlinery Team &bull; In Stock</div>
                    <div id="p-price" style="font-size: 1.5rem; color: #b12704; font-weight: bold; margin-bottom: 20px;">$9.99</div>
                    
                    <div id="p-desc" class="product-desc">
                        Description loading...
                    </div>

                    <div class="amazon-box">
                        <a href="#" id="btn-cart" target="_blank" class="amz-btn amz-cart">Add to Cart</a>
                        <a href="#" id="btn-buy" target="_blank" class="amz-btn amz-buy">Buy on Amazon</a>
                        <p style="text-align:center; font-size:0.8rem; color:#666; margin-top:10px;">
                            Secure transaction via Amazon.com
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ADDED: NEWSLETTER SECTION -->
    <section class="newsletter-section">
        <div class="newsletter-container">
            <h2>Join the Inner Circle</h2>
            <p>Get exclusive sneak peeks, free coloring pages, and launch discounts delivered to your inbox.</p>
            
            <!-- Replace 'YOUR_FORMSPREE_ID' with your real code from Formspree.io -->
            <form class="newsletter-form" action="https://formspree.io/f/YOUR_FORMSPREE_ID" method="POST" id="email-form">
                <input type="email" name="email" placeholder="Enter your email address" required>
                <button type="submit">Subscribe</button>
            </form>
            <p id="form-message" style="display:none; margin-top:15px; color:#a2ffb6;">Thanks for subscribing!</p>
        </div>
    </section>

    <footer>
        <div style="font-family: 'Playfair Display', serif; font-size: 1.8rem; margin-bottom: 1rem;">The Outlinery</div>
        <p>&copy; 2026 The Outlinery. All rights reserved.</p>
    </footer>

    <!-- ADDED: COOKIE BANNER HTML -->
    <div class="cookie-banner" id="cookie-banner">
        <span>We use cookies to ensure you get the best experience on our website.</span>
        <button class="cookie-btn" onclick="acceptCookies()">Accept</button>
    </div>

    <script>
        /* --- REAL INVENTORY DATA --- */
        const inventory = [
            {
                id: 1,
                title: "Christmas Coloring Book: 50 Bold and Easy-to-Color Festive Scenes",
                category: "Coloring Book",
                price: "$7.99",
                // Note: I replaced newlines with actual line breaks for the HTML logic
                desc: "Unwrap hours of festive fun this holiday season!\n\nBring the magic of Christmas to life with the Christmas Coloring Book! Perfect for ages 6 and up, this Christmas-themed coloring book features 50 bold and easy-to-color festive scenes that will spark creativity and holiday cheer. Itâ€™s designed to provide hours of fun and keep the holiday excitement alive.\n\nEach page is simple enough to complete in one sitting, whether you are looking for a screen-free activity for a snowy afternoon or a way to calm excited minds before the big day.\n\nWhy you and your child will love this book:\nâ€¢ 50 Unique Illustrations: No repeats! Packed with Reindeer, Snowmen, Ornaments, Gingerbread houses, and more.\nâ€¢ Bold & Easy Designs: Thick lines make coloring satisfying for kids (and relaxing for adults!) without being too babyish.\nâ€¢ Single-Sided Pages: Every image is placed on its own page to prevent bleed-through issues, making it ideal for markers, gel pens, and colored pencils.\nâ€¢ Perfect Square Format: The 8.5 x 8.5-inch size is easy for little hands to manage and looks great under the tree.\n\nThe Perfect Holiday Gift!\nThis coloring book makes an ideal stocking stuffer, Secret Santa gift, or classroom holiday treat for young artists.",
                link: "https://www.amazon.com/dp/B0DQJ9T211",
                images: ["images/book1-front.jpg", "images/book1-back.jpg"] 
            },
            {
                id: 2,
                title: "Romantic Valentine Coloring Book: 48 Relaxing and Easy Romantic Illustrations",
                category: "Coloring Book",
                price: "$7.99",
                desc: "ðŸ’– Celebrate Love with the Perfect Romantic Valentine Coloring Book! ðŸ’–\n\nLooking for a relaxing and heartwarming way to embrace the spirit of love? This Romantic Valentine Coloring Book features 48 beautifully designed illustrations of romantic scenes, heartfelt moments, and love-themed objectsâ€”perfect for sparking joy and creativity.\n\nðŸŒ¹ Why Youâ€™ll Love This Coloring Book:\nâœ” Relaxation & Creativity â€“ Escape stress and unwind while bringing these lovely scenes to life.\nâœ” Romantic & Heartfelt Designs â€“ Enjoy charming illustrations of couples, dreamy settings, and love-filled symbols.\nâœ” Perfect for All Skill Levels â€“ Designed for teens, adults, and seniors, whether you're a beginner or an expert.\nâœ” A Thoughtful Gift for Loved Ones â€“ Makes a unique Valentineâ€™s Day, anniversary, or birthday gift, stocking stuffer, or a fun treat for young artists and creative souls alike.\nâœ” Fun & Engaging â€“ Each page is simple enough to complete in one sitting, making it perfect for cozy afternoons or creative family activities.\n\nðŸŽ¨ Whatâ€™s Inside:\nðŸ“Œ 48 Beautiful Coloring Pages â€“ Featuring romantic settings, heartfelt decorations, and love-inspired objects.\nðŸ“Œ Single-Sided Pages â€“ Prevents bleed-through, making it easy to use markers, crayons, or colored pencils.\nðŸ“Œ Convenient 8.25 x 11-inch Format â€“ Spacious yet portable, ideal for easy handling and coloring fun anywhere.\n\nðŸ–Œ Helpful Coloring Tips:\nâœ” Use a hard sheet or board behind the coloring page to avoid bleed-through.\nâœ” Avoid using markers that may smudge on detailed designs.\n\nðŸ“– ðŸ’˜ Now available in both hardcover and paperback!\nDesigned for ages 12 and up, this special edition captures the joy of love and artistic expression.\n\nðŸ’˜ Grab your copy today and color your way into a world of love and romance!",
                link: "https://www.amazon.com/dp/B0DVZP3Y3B",
                images: ["images/book2-front.jpg", "images/book2-back.jpg"] 
            },
            {
                id: 3,
                title: "Lined Writing Journal: Notebook for Women and Men, 164 Pages, 8.5â€ x 11 Inches",
                category: "Journal",
                price: "$6.99",
                desc: "The Ultimate Hybrid Journal and Notebook for Every Occasion! ðŸ“˜\n\nWhether youâ€™re jotting down notes for class, organizing work tasks, or planning your next big idea, this lined hybrid journal and notebook has you covered. As your daily companion to organize your life and unlock your productivity, its stylish design and practical features make it perfect for students, professionals, and creative minds alike.\n\nWhy Youâ€™ll Love This Notebook:\nâ€¢ Standard Letter Size (8.5 x 11 inches): Spacious enough for all your notes, yet perfectly portable to fit in your bag.\nâ€¢ Beautiful Cover Design: Features a gorgeous geometric pattern with elegant circles and curved lines, making it a perfect gift for any occasion.\nâ€¢ Versatile Usage: Great for note-taking in school or college, journaling, brainstorming, or personal writing like meal recipes, mood tracking, and password storage.\nâ€¢ High-Quality Paper: Smooth, lined pages that work perfectly with pens, pencils, or markers.\nâ€¢ Perfect for Gifting: Makes an excellent graduation gift, Motherâ€™s Day gift, Christmas gift, New Yearâ€™s gift, or birthday gift.\n\nðŸ‘‰ Order yours now and take the first step toward staying organized and inspired!",
                link: "https://www.amazon.com/dp/B0DRGFCQ95",
                images: ["images/book3-front.jpg", "images/book3-back.jpg"] 
            }
        ];

        let currentProduct = null;
        let slideIndex = 0;

        window.onload = function() {
            renderGrid();
            checkCookies(); // Trigger Cookie Check
            registerServiceWorker(); // Trigger Cache Registration
        };

        /* --- ROUTER --- */
        function router(viewName, productId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(el => el.classList.remove('active'));

            if(viewName === 'product' && productId) {
                loadProduct(productId);
                document.getElementById('view-product').classList.add('active');
                document.getElementById('nav-shop').classList.add('active');
            } else {
                document.getElementById('view-' + viewName).classList.add('active');
                const navBtn = document.getElementById('nav-' + viewName);
                if(navBtn) navBtn.classList.add('active');
            }
            window.scrollTo(0,0);
        }

        /* --- ERROR HANDLER --- */
        function handleImageError(img) {
            img.style.display = 'none';
            // Simple robust fallback
            img.parentElement.innerHTML = '<div style="text-align:center; padding:10px; color:#aaa;">Image Not Found</div>';
        }

        /* --- RENDER GRID --- */
        function renderGrid() {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';

            inventory.forEach(item => {
                const card = document.createElement('div');
                card.className = 'book-card';
                card.onclick = () => router('product', item.id);

                // We try to use the first image. If it fails (file not found), it shows a gray box.
                const coverImage = item.images.length > 0 ? item.images[0] : '';

                card.innerHTML = `
                    <div class="book-cover">
                        <img src="${coverImage}" onerror="handleImageError(this)">
                    </div>
                    <div class="book-info">
                        <span class="category">${item.category}</span>
                        <h3>${item.title}</h3>
                        <div class="price">${item.price}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        /* --- LOAD PRODUCT DETAIL --- */
        function loadProduct(id) {
            currentProduct = inventory.find(p => p.id === id);
            
            document.getElementById('p-title').innerText = currentProduct.title;
            document.getElementById('p-price').innerText = currentProduct.price;
            document.getElementById('p-desc').innerText = currentProduct.desc;
            document.getElementById('btn-cart').href = currentProduct.link;
            document.getElementById('btn-buy').href = currentProduct.link;

            setupGallery(currentProduct.images);
        }

        /* --- GALLERY LOGIC --- */
        function setupGallery(images) {
            const track = document.getElementById('track');
            const dots = document.getElementById('dots-container');
            track.innerHTML = '';
            dots.innerHTML = '';
            slideIndex = 0;

            images.forEach((img, idx) => {
                const slide = document.createElement('div');
                slide.className = 'gallery-slide';
                slide.innerHTML = `<img src="${img}" onerror="handleImageError(this)">`;
                track.appendChild(slide);

                const dot = document.createElement('div');
                dot.className = idx === 0 ? 'dot active' : 'dot';
                dots.appendChild(dot);
            });
            updateGallery();
        }

        function moveSlide(n) {
            const total = currentProduct.images.length;
            slideIndex += n;
            if(slideIndex >= total) slideIndex = 0;
            if(slideIndex < 0) slideIndex = total - 1;
            updateGallery();
        }

        function updateGallery() {
            const track = document.getElementById('track');
            track.style.transform = `translateX(-${slideIndex * 100}%)`;
            
            document.querySelectorAll('.dot').forEach((d, i) => {
                d.classList.toggle('active', i === slideIndex);
            });
        }

        /* --- TOUCH SWIPE --- */
        let xDown = null;
        const touchArea = document.getElementById('gallery-touch-area');
        
        touchArea.addEventListener('touchstart', (evt) => { xDown = evt.touches[0].clientX; }, false);
        touchArea.addEventListener('touchmove', (evt) => {
            if (!xDown) return;
            let xUp = evt.touches[0].clientX;
            let xDiff = xDown - xUp;

            if (Math.abs(xDiff) > 50) { 
                if (xDiff > 0) moveSlide(1); 
                else moveSlide(-1);
                xDown = null;
            }
        }, false);

        /* --- ADDED: COOKIE LOGIC --- */
        function checkCookies() {
            if (!localStorage.getItem('cookiesAccepted')) {
                setTimeout(() => document.getElementById('cookie-banner').classList.add('show'), 1000);
            }
        }
        function acceptCookies() {
            localStorage.setItem('cookiesAccepted', 'true');
            document.getElementById('cookie-banner').classList.remove('show');
        }

        /* --- ADDED: SERVICE WORKER REGISTRATION --- */
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js').then(reg => {
                        console.log('Cache Ready: ', reg.scope);
                    }, err => {
                        console.log('Cache Fail: ', err);
                    });
                });
            }
        }

        /* --- ADDED: FORM HANDLING --- */
        document.getElementById('email-form').addEventListener('submit', function(e) {
            if(this.action.includes("YOUR_FORMSPREE_ID")) {
                e.preventDefault();
                document.getElementById('form-message').style.display = 'block';
                this.reset();
            }
        });
    </script>
</body>
</html>
